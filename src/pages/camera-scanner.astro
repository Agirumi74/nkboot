---
import Layout from "@layouts/BaseLayout.astro";
import Text from "@atoms/Text.astro";
import Section from "@atoms/Section.astro";
import Wrapper from "@atoms/Wrapper2.astro";
import CameraCapture from "@organisms/CameraCapture.astro";
import QRScanner from "@organisms/QRScanner.astro";
---

<Layout title="Camera et Scanner - D√©monstration" description="D√©monstration des fonctionnalit√©s de capture photo et de scan de codes QR/barres.">
  {(org) => (
    <>
      <!-- Hero Section -->
      <Section id="hero" tag="header" preset="primary" display="flex" minHeight="40vh" justifyContent="center" alignItems="center">
        <Wrapper cols={1} display="flex" flexDirection="column" justifyContent="center" alignItems="center" gap="2rem">
          <Text tag="h1">
            üì∏ Camera & Scanner
          </Text>
          <Text tag="p">
            D√©monstration des fonctionnalit√©s de capture photo et de scan de codes QR/barres
          </Text>
        </Wrapper>
      </Section>

      <!-- Camera Capture Section -->
      <Section id="camera-section" tag="section" preset="default">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:camera">
            Capture Photo
          </Text>
          <Text tag="p">
            Utilisez votre cam√©ra pour prendre des photos. La fonctionnalit√© fonctionne sur desktop, mobile et tablette.
          </Text>
        </Wrapper>

        <Wrapper cols={1} gap="2rem" display="grid" maxWidth="800px" margin="0 auto">
          <!-- Primary Camera -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:camera-outline">
              Camera Primary
            </Text>
            <CameraCapture 
              id="camera-primary"
              preset="primary"
              showPreview={true}
              allowDownload={true}
              maxHeight="500px"
            />
          </Section>

          <!-- Secondary Camera (Compact) -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:camera-front">
              Camera Compact
            </Text>
            <CameraCapture 
              id="camera-compact"
              preset="secondary"
              showPreview={false}
              allowDownload={false}
              maxHeight="300px"
            />
          </Section>
        </Wrapper>
      </Section>

      <!-- QR Scanner Section -->
      <Section id="scanner-section" tag="section" preset="accent">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:qrcode-scan">
            Scanner QR / Code-barres
          </Text>
          <Text tag="p">
            Scannez des codes QR et codes-barres en temps r√©el. L'historique des scans est automatiquement sauvegard√©.
          </Text>
        </Wrapper>

        <Wrapper cols={1} gap="2rem" display="grid" maxWidth="800px" margin="0 auto">
          <!-- Primary QR Scanner -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:qrcode">
              Scanner Principal
            </Text>
            <QRScanner 
              id="qr-scanner-main"
              preset="primary"
              showHistory={true}
              copyToClipboard={true}
              maxHeight="500px"
            />
          </Section>

          <!-- Compact QR Scanner -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:barcode-scan">
              Scanner Compact
            </Text>
            <QRScanner 
              id="qr-scanner-compact"
              preset="accent"
              showHistory={false}
              copyToClipboard={true}
              maxHeight="300px"
            />
          </Section>
        </Wrapper>
      </Section>

      <!-- Features Section -->
      <Section id="features" tag="section" preset="default">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:feature-search">
            Fonctionnalit√©s
          </Text>
        </Wrapper>

        <Wrapper cols={2} gap="2rem" display="grid">
          <!-- Camera Features -->
          <Section tag="div" preset="default" border shadow>
            <Text tag="h3" iconLeft="mdi:camera-enhance">
              üì∏ Capture Photo
            </Text>
            <ul>
              <li>‚úÖ Acc√®s camera front/back</li>
              <li>‚úÖ Changement de cam√©ra en un clic</li>
              <li>‚úÖ Aper√ßu en temps r√©el</li>
              <li>‚úÖ Capture haute qualit√©</li>
              <li>‚úÖ T√©l√©chargement automatique</li>
              <li>‚úÖ Compatible mobile/desktop</li>
              <li>‚úÖ Gestion des permissions</li>
              <li>‚úÖ Messages d'erreur explicites</li>
            </ul>
          </Section>

          <!-- Scanner Features -->
          <Section tag="div" preset="default" border shadow>
            <Text tag="h3" iconLeft="mdi:qrcode-plus">
              üîç Scanner QR/Codes
            </Text>
            <ul>
              <li>‚úÖ Scan QR codes en temps r√©el</li>
              <li>‚úÖ Support codes-barres multiples</li>
              <li>‚úÖ D√©tection automatique</li>
              <li>‚úÖ Copie vers presse-papier</li>
              <li>‚úÖ Historique des scans</li>
              <li>‚úÖ Sauvegarde locale</li>
              <li>‚úÖ Liens cliquables</li>
              <li>‚úÖ Interface intuitive</li>
            </ul>
          </Section>
        </Wrapper>
      </Section>

      <!-- Compatibility Section -->
      <Section id="compatibility" tag="section" preset="secondary">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:devices">
            Compatibilit√©
          </Text>
          <Text tag="p">
            Ces fonctionnalit√©s sont optimis√©es pour fonctionner sur tous les appareils modernes.
          </Text>
        </Wrapper>

        <Wrapper cols={3} gap="2rem" display="grid">
          <!-- Desktop -->
          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:desktop-mac">
              üñ•Ô∏è Desktop
            </Text>
            <ul>
              <li>Chrome 53+</li>
              <li>Firefox 36+</li>
              <li>Safari 11+</li>
              <li>Edge 79+</li>
            </ul>
          </Section>

          <!-- Mobile -->
          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:cellphone">
              üì± Mobile
            </Text>
            <ul>
              <li>iOS Safari 11+</li>
              <li>Chrome Mobile 53+</li>
              <li>Firefox Mobile 68+</li>
              <li>Samsung Internet 6.2+</li>
            </ul>
          </Section>

          <!-- Tablet -->
          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:tablet">
              üî≤ Tablette
            </Text>
            <ul>
              <li>iPad Safari 11+</li>
              <li>Android Chrome 53+</li>
              <li>Surface Edge 79+</li>
              <li>Interface tactile optimis√©e</li>
            </ul>
          </Section>
        </Wrapper>
      </Section>

      <!-- Usage Instructions -->
      <Section id="instructions" tag="section" preset="default">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:help-circle">
            Instructions d'utilisation
          </Text>
        </Wrapper>

        <Wrapper cols={2} gap="2rem" display="grid">
          <!-- Camera Instructions -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:camera-timer">
              üì∏ Utilisation de la Camera
            </Text>
            <ol>
              <li><strong>Cliquer sur "D√©marrer la cam√©ra"</strong> - Autorisez l'acc√®s √† la cam√©ra</li>
              <li><strong>Changer de cam√©ra</strong> - Utilisez le bouton "Changer cam√©ra" pour basculer front/back</li>
              <li><strong>Capturer</strong> - Cliquez sur "Capturer" pour prendre la photo</li>
              <li><strong>T√©l√©charger</strong> - La photo appara√Æt dans l'aper√ßu avec un lien de t√©l√©chargement</li>
              <li><strong>Arr√™ter</strong> - Cliquez sur "Arr√™ter" pour fermer la cam√©ra</li>
            </ol>
          </Section>

          <!-- Scanner Instructions -->
          <Section tag="div" preset="default">
            <Text tag="h3" iconLeft="mdi:qrcode-edit">
              üîç Utilisation du Scanner
            </Text>
            <ol>
              <li><strong>D√©marrer le scanner</strong> - Autorisez l'acc√®s √† la cam√©ra</li>
              <li><strong>Positionner le code</strong> - Placez le QR code ou code-barres dans le cadre</li>
              <li><strong>D√©tection automatique</strong> - Le scan se fait automatiquement</li>
              <li><strong>Copier le r√©sultat</strong> - Utilisez le bouton "Copier" pour copier le contenu</li>
              <li><strong>Historique</strong> - Tous les scans sont sauvegard√©s dans l'historique</li>
            </ol>
          </Section>
        </Wrapper>
      </Section>

      <!-- Troubleshooting Section -->
      <Section id="troubleshooting" tag="section" preset="default">
        <Wrapper cols={1} gap="2rem">
          <Text tag="h2" iconLeft="mdi:alert-circle">
            D√©pannage
          </Text>
        </Wrapper>

        <Wrapper cols={1} gap="1.5rem">
          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:camera-off">
              ‚ùå "Acc√®s √† la cam√©ra refus√©"
            </Text>
            <ul>
              <li>V√©rifiez les param√®tres de votre navigateur</li>
              <li>Assurez-vous d'√™tre sur une connexion HTTPS</li>
              <li>Rechargez la page et accordez l'autorisation</li>
              <li>V√©rifiez qu'aucune autre application n'utilise la cam√©ra</li>
            </ul>
          </Section>

          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:camera-wireless-outline">
              üîç "Aucune cam√©ra trouv√©e"
            </Text>
            <ul>
              <li>V√©rifiez que votre appareil dispose d'une cam√©ra</li>
              <li>Red√©marrez votre navigateur</li>
              <li>Mettez √† jour votre navigateur vers la derni√®re version</li>
              <li>Testez sur un autre navigateur</li>
            </ul>
          </Section>

          <Section tag="div" preset="default" border>
            <Text tag="h3" iconLeft="mdi:qrcode-remove">
              üì± "Le scanner ne d√©tecte pas les codes"
            </Text>
            <ul>
              <li>Assurez-vous que le code est bien √©clair√©</li>
              <li>Tenez l'appareil stable</li>
              <li>Rapprochez ou √©loignez le code de la cam√©ra</li>
              <li>Nettoyez l'objectif de la cam√©ra</li>
            </ul>
          </Section>
        </Wrapper>
      </Section>

    </>
  )}
</Layout>